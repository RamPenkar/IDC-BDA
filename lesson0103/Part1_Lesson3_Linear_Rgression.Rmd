---
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Business Data Analytics and Prediction</br>
*Dr. Gilli Shama *

## Lesson 1.3 Regression in R 

### Prepare the data
Verify that you read the dataframe to memory and split to train and test, with same seed as before:

```{r}
df <- read.csv('C:/Users/gillis/Documents/_Personal/IDC/Business_Data_Analytics/human-resources-analytics/HR_comma_sep.csv') # Change this path to your downloaded file

set.seed(111)
bound <- floor((nrow(df)/4)*3)
d <- df[sample(nrow(df)), ]
df.train <- d[1:bound, ]
df.test <- d[(bound+1):nrow(df), ]

```

### Learn the model
Define the data for regression and run the regression model into a new variable:
```{r}
hrs = df.train[df.train$left == 1 ,4]
projects = df.train[df.train$left == 1 ,3]

reg_hrs_projects <- lm(hrs ~ projects)
```

Typing only the model variable gives a short information:
```{r}
reg_hrs_projects
```


To visualize the regression line plot a scatter plot of the x and y data and then add to it the linear line:
```{r}
plot(y=hrs, x=projects)
abline(reg_hrs_projects)
```

### Model's statistics

Summary gives detailed information:
```{r}
summary(reg_hrs_projects)
```

To visualize the regression residuals you can plot the regression variable:
```{r}
plot(reg_hrs_projects)
```

